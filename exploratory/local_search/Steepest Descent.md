# Steepest Descent: 最急降下法

**最急降下法（Steepest Descent）**は、勾配降下法の一種で、目的関数の勾配方向に最も急な降下方向に移動する局所探索手法です。各反復で最適なステップサイズを選択することで、効率的に最小値に近づきます。

---

### 1. 基本的なアイデア

**最急降下の方向**:
- **勾配方向**: 関数の最も急な上昇方向
- **負の勾配方向**: 関数の最も急な下降方向
- **最適ステップサイズ**: 勾配方向での最適な移動距離

---

### 2. アルゴリズムの流れ

```
1. 初期点 x_0 を設定
2. 終了条件を満たすまで繰り返し:
   a. 勾配 ∇f(x_t) を計算
   b. 探索方向 d_t = -∇f(x_t) を設定
   c. 直線探索で最適ステップサイズ α_t を求める
   d. x_{t+1} = x_t + α_t d_t で更新
3. 最適解 x* を返す
```

---

### 3. 数式による定式化

#### 3.1 更新式

目的関数 \(f(x)\) を最小化：
\[
x_{t+1} = x_t - \alpha_t \nabla f(x_t)
\]

#### 3.2 最適ステップサイズ

直線探索により最適ステップサイズを決定：
\[
\alpha_t = \arg\min_{\alpha > 0} f(x_t - \alpha \nabla f(x_t))
\]

#### 3.3 一次条件

最適ステップサイズの一次条件：
\[
\nabla f(x_t - \alpha_t \nabla f(x_t))^T \nabla f(x_t) = 0
\]

---

### 4. XAIへの応用

#### 4.1 説明の最適化

**問題**: 最適な説明を生成する

**Steepest Descentの適用**:
- **目的関数**: 説明の品質（忠実度、簡潔性）
- **変数**: 説明のパラメータ
- **勾配**: 説明の品質に対するパラメータの感度
- **目的**: 高品質な説明を見つける

#### 4.2 特徴の重要度の推定

**問題**: 特徴の重要度を推定する

**Steepest Descentの適用**:
- **目的関数**: 予測誤差
- **変数**: 特徴の重み
- **勾配**: 特徴の重要度
- **目的**: 特徴の重要度を推定

#### 4.3 反事実説明の生成

**問題**: 予測を変える最小の変更を見つける

**Steepest Descentの適用**:
- **目的関数**: 予測の変化量 + 変更のコスト
- **変数**: 入力の変更量
- **勾配**: 予測に対する入力の感度
- **目的**: 最小の変更で予測を変える

---

### 5. 利点と欠点

**利点**:
- 各反復で最適なステップサイズを選択
- 収束が比較的速い
- 実装が比較的簡単

**欠点**:
- 直線探索の計算コストが高い
- 局所最適解に陥る可能性がある
- 非凸問題では最適解が保証されない

---

### 6. 実装上の注意点

- **直線探索**: 黄金分割法、二分法など
- **収束判定**: 勾配のノルムや目的関数の変化量
- **初期値**: 局所最適解に依存
- **数値安定性**: 浮動小数点演算の誤差に注意

---

### 7. バリエーション

- **標準Steepest Descent**: 上記の基本アルゴリズム
- **共役勾配法**: 共役方向を使用
- **準ニュートン法**: ヘッセ行列の近似を使用
- **信頼領域法**: 信頼領域内で最適化

---

### 8. 参考文献

- Cauchy, A. (1847). Méthode générale pour la résolution des systèmes d'équations simultanées. *Comptes Rendus de l'Académie des Sciences*, 25, 536-538.
- Nocedal, J., & Wright, S. (2006). *Numerical Optimization* (2nd ed.). Springer.

---

### 9. まとめ

最急降下法は、最適なステップサイズを選択する勾配降下法の一種です。XAIにおいては、説明の最適化、特徴の重要度の推定、反事実説明の生成などに応用されています。各反復で最適なステップサイズを選択することで、効率的に最適解に近づくことができます。

