# Linear Programming: 線形計画法

**線形計画法（Linear Programming, LP）**は、線形制約の下で線形目的関数を最適化する厳密探索手法です。シンプレックス法や内点法などの効率的なアルゴリズムにより、最適解を保証しながら大規模な問題も解くことができます。

---

### 1. 基本的なアイデア

**線形計画問題**:
- **目的関数**: 線形関数を最大化または最小化
- **制約条件**: 線形等式・不等式制約
- **変数**: 非負制約を持つ連続変数
- **最適解**: 実行可能領域の頂点に存在

---

### 2. 標準形

#### 2.1 標準最大化問題

\[
\begin{aligned}
\max \quad & c^T x \\
\text{s.t.} \quad & Ax \leq b \\
& x \geq 0
\end{aligned}
\]

ここで：
- \(c \in \mathbb{R}^n\): 目的関数の係数ベクトル
- \(A \in \mathbb{R}^{m \times n}\): 制約行列
- \(b \in \mathbb{R}^m\): 制約の右辺ベクトル
- \(x \in \mathbb{R}^n\): 決定変数ベクトル

#### 2.2 双対問題

主問題の双対：
\[
\begin{aligned}
\min \quad & b^T y \\
\text{s.t.} \quad & A^T y \geq c \\
& y \geq 0
\end{aligned}
\]

---

### 3. アルゴリズム

#### 3.1 シンプレックス法

**基本的な流れ**:
1. 初期基底解を見つける
2. 最適性をチェック
3. 最適でなければ、基底変数を入れ替え
4. 最適解に到達するまで繰り返し

#### 3.2 内点法

**基本的な流れ**:
1. 実行可能領域の内部から開始
2. 最適解に向かって内部を移動
3. 最適解に収束

---

### 4. XAIへの応用

#### 4.1 特徴選択

**問題**: どの特徴が予測に重要かを見つける

**Linear Programmingの適用**:
- **変数**: 特徴の選択（0-1変数）
- **目的関数**: 特徴の重要度の線形和
- **制約**: 特徴数の制限、性能の下限
- **目的**: 最適な特徴集合を見つける

#### 4.2 説明の最適化

**問題**: 最適な説明を生成する

**Linear Programmingの適用**:
- **変数**: 特徴の重み
- **目的関数**: 説明の品質（忠実度、簡潔性）
- **制約**: 説明の制約（特徴数の上限など）
- **目的**: 最適な説明を見つける

#### 4.3 公平性制約

**問題**: 公平性を保ちながら最適な説明を生成する

**Linear Programmingの適用**:
- **変数**: 説明のパラメータ
- **目的関数**: 説明の品質
- **制約**: 公平性制約（線形）
- **目的**: 公平で最適な説明を見つける

---

### 5. 利点と欠点

**利点**:
- 最適解が保証される
- 効率的なアルゴリズム（シンプレックス法、内点法）
- 大規模な問題も解ける
- 双対理論により深い洞察が得られる

**欠点**:
- 線形性の仮定が必要
- 整数変数には適用できない（整数計画法が必要）
- 非線形問題には適用できない

---

### 6. 実装上の注意点

- **標準形への変換**: 問題を標準形に変換する必要がある
- **初期解**: シンプレックス法では初期基底解を見つける必要がある
- **数値安定性**: 浮動小数点演算の誤差に注意
- **大規模問題**: 内点法が大規模問題に適している

---

### 7. バリエーション

- **標準LP**: 上記の基本形
- **整数計画法（IP）**: 変数が整数
- **混合整数計画法（MIP）**: 一部の変数が整数
- **双対シンプレックス法**: 双対問題を解く

---

### 8. 参考文献

- Dantzig, G. B. (1951). Maximization of a linear function of variables subject to linear inequalities. *Activity Analysis of Production and Allocation*, 339-347.
- Karmarkar, N. (1984). A new polynomial-time algorithm for linear programming. *Combinatorica*, 4(4), 373-395.

---

### 9. まとめ

線形計画法は、最適解を保証する強力な厳密探索手法です。XAIにおいては、特徴選択、説明の最適化、公平性制約などに応用されています。効率的なアルゴリズムにより、大規模な問題も解くことができるため、実用的な手法として広く使われています。

