# PSO: Particle Swarm Optimization（粒子群最適化）

**粒子群最適化（Particle Swarm Optimization, PSO）**は、鳥の群れや魚の群れの行動を模倣したメタヒューリスティック最適化手法です。粒子（解の候補）が、個体の最良位置と群れ全体の最良位置に向かって移動することで、最適解を探索します。

---

### 1. 基本的なアイデア

**群れのメタファー**:
- **粒子（Particle）**: 解の候補
- **位置（Position）**: 解空間内の粒子の位置
- **速度（Velocity）**: 粒子の移動方向と速度
- **個体最良位置（Personal Best, pBest）**: 各粒子がこれまでに見つけた最良位置
- **群れ最良位置（Global Best, gBest）**: 群れ全体でこれまでに見つけた最良位置

---

### 2. アルゴリズムの流れ

```
1. 粒子群の初期化（位置と速度をランダムに設定）
2. 各粒子の適応度を評価
3. 個体最良位置と群れ最良位置を更新
4. 終了条件を満たすまで繰り返し:
   a. 各粒子の速度を更新
   b. 各粒子の位置を更新
   c. 各粒子の適応度を評価
   d. 個体最良位置と群れ最良位置を更新
5. 群れ最良位置を返す
```

---

### 3. 数式による定式化

#### 3.1 速度の更新

粒子 \(i\) の速度 \(v_i(t+1)\) は以下のように更新：
\[
v_i(t+1) = w \cdot v_i(t) + c_1 \cdot r_1 \cdot (p_i - x_i(t)) + c_2 \cdot r_2 \cdot (g - x_i(t))
\]

ここで：
- \(w\): 慣性重み（Inertia Weight）
- \(c_1, c_2\): 加速係数（通常 \(c_1 = c_2 = 2\)）
- \(r_1, r_2\): [0,1]の一様乱数
- \(p_i\): 粒子 \(i\) の個体最良位置
- \(g\): 群れ全体の最良位置
- \(x_i(t)\): 粒子 \(i\) の現在位置

#### 3.2 位置の更新

粒子 \(i\) の位置 \(x_i(t+1)\) は以下のように更新：
\[
x_i(t+1) = x_i(t) + v_i(t+1)
\]

#### 3.3 慣性重み

慣性重み \(w\) は、探索と収束のバランスを制御：
\[
w(t) = w_{\max} - \frac{w_{\max} - w_{\min}}{t_{\max}} \cdot t
\]

通常、\(w_{\max} = 0.9\)、\(w_{\min} = 0.4\)。

---

### 4. XAIへの応用

#### 4.1 特徴選択

**問題**: どの特徴が予測に重要かを見つける

**PSOの適用**:
- **粒子**: 特徴の選択パターン（バイナリベクトルまたは連続値）
- **適応度**: 選択された特徴でのモデル性能
- **目的**: 少ない特徴で高い性能を達成

#### 4.2 説明の最適化

**問題**: 最適な説明を生成する

**PSOの適用**:
- **粒子**: 説明の候補（特徴の重み、ルールなど）
- **適応度**: 説明の品質（忠実度、簡潔性）
- **目的**: 高品質な説明を見つける

#### 4.3 ハイパーパラメータ最適化

**問題**: XAI手法のハイパーパラメータを最適化する

**PSOの適用**:
- **粒子**: ハイパーパラメータの組み合わせ
- **適応度**: 説明の品質やモデル性能
- **目的**: 最適なハイパーパラメータを見つける

---

### 5. 利点と欠点

**利点**:
- 実装が簡単
- パラメータが少ない
- 収束が速い
- 連続最適化問題に適している

**欠点**:
- 離散問題への適用が難しい場合がある
- 局所最適解に陥る可能性がある
- 高次元問題では性能が低下する場合がある

---

### 6. 実装上の注意点

- **粒子数**: 通常20～50個
- **加速係数**: \(c_1 = c_2 = 2\) が一般的
- **速度制限**: 速度が大きくなりすぎないように制限を設ける
- **境界処理**: 粒子が解空間の外に出ないように処理

---

### 7. バリエーション

- **標準PSO**: 上記の基本アルゴリズム
- **慣性重みPSO**: 慣性重みを時間とともに減少させる
- **Constriction PSO**: 収束性を改善したバージョン
- **Multi-swarm PSO**: 複数の群れを使用

---

### 8. まとめ

粒子群最適化は、群れの行動を模倣した直感的で効果的な最適化手法です。XAIにおいては、特徴選択、説明の最適化、ハイパーパラメータ最適化などに応用されています。実装が簡単で収束が速いため、実用的な手法として広く使われています。

