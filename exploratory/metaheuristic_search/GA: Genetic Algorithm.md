# GA: Genetic Algorithm（遺伝的アルゴリズム）

**遺伝的アルゴリズム（Genetic Algorithm, GA）**は、生物の進化過程を模倣したメタヒューリスティック最適化手法です。自然選択、交叉、突然変異などの遺伝的操作を用いて、解空間を探索します。

---

### 1. 基本的なアイデア

**進化のメタファー**:
- **個体（Individual）**: 解の候補（染色体で表現）
- **集団（Population）**: 複数の個体の集合
- **適応度（Fitness）**: 解の良さを評価する関数
- **選択（Selection）**: 適応度の高い個体を優先的に選択
- **交叉（Crossover）**: 2つの親個体から子個体を生成
- **突然変異（Mutation）**: 個体にランダムな変化を加える

---

### 2. アルゴリズムの流れ

```
1. 初期集団の生成
2. 適応度の評価
3. 終了条件を満たすまで繰り返し:
   a. 選択: 適応度の高い個体を選択
   b. 交叉: 選択された個体から子個体を生成
   c. 突然変異: 子個体に突然変異を適用
   d. 適応度の評価
   e. 次世代の集団を更新
4. 最良解を返す
```

---

### 3. 数式による定式化

#### 3.1 個体の表現

個体 \(x\) は、\(n\) 次元のベクトルとして表現：
\[
x = (x_1, x_2, \ldots, x_n)
\]

#### 3.2 適応度関数

目的関数 \(f(x)\) を最大化（または最小化）する：
\[
\text{Fitness}(x) = f(x)
\]

#### 3.3 選択操作

適応度比例選択（ルーレット選択）：
\[
P(x_i) = \frac{\text{Fitness}(x_i)}{\sum_{j=1}^{N} \text{Fitness}(x_j)}
\]

ここで、\(N\) は集団サイズ、\(P(x_i)\) は個体 \(x_i\) が選択される確率。

#### 3.4 交叉操作

一点交叉の場合：
\[
\begin{aligned}
x_{\text{child1}} &= (x_{\text{parent1},1}, \ldots, x_{\text{parent1},k}, x_{\text{parent2},k+1}, \ldots, x_{\text{parent2},n}) \\
x_{\text{child2}} &= (x_{\text{parent2},1}, \ldots, x_{\text{parent2},k}, x_{\text{parent1},k+1}, \ldots, x_{\text{parent1},n})
\end{aligned}
\]

#### 3.5 突然変異操作

各遺伝子 \(x_i\) に対して、確率 \(p_m\) で突然変異：
\[
x_i \leftarrow x_i + \delta
\]

ここで、\(\delta\) はランダムな変動量。

---

### 4. XAIへの応用

#### 4.1 特徴選択

**問題**: どの特徴が予測に重要かを見つける

**GAの適用**:
- **個体**: 特徴の選択パターン（バイナリベクトル）
- **適応度**: 選択された特徴でのモデル性能
- **目的**: 少ない特徴で高い性能を達成

#### 4.2 説明の最適化

**問題**: 最適な説明を生成する

**GAの適用**:
- **個体**: 説明の候補（ルール、特徴の組み合わせなど）
- **適応度**: 説明の品質（忠実度、簡潔性、理解しやすさ）
- **目的**: 高品質な説明を見つける

#### 4.3 ルール抽出

**問題**: 決定木やルールセットを最適化する

**GAの適用**:
- **個体**: ルールセット
- **適応度**: ルールの精度と簡潔性
- **目的**: 高精度で簡潔なルールセットを見つける

---

### 5. 利点と欠点

**利点**:
- 複雑な非線形問題に対応可能
- 局所最適解に陥りにくい
- 並列化が容易
- 離散・連続両方の問題に適用可能

**欠点**:
- 収束が遅い場合がある
- パラメータ調整が必要
- 最適解の保証がない
- 計算コストが高い場合がある

---

### 6. 実装上の注意点

- **集団サイズ**: 大きすぎると計算コストが高い、小さすぎると多様性が失われる
- **交叉率**: 通常0.6～0.9
- **突然変異率**: 通常0.01～0.1
- **エリート選択**: 最良個体を次世代に残すことで性能を維持

---

### 7. まとめ

遺伝的アルゴリズムは、進化のメタファーを用いた強力な最適化手法です。XAIにおいては、特徴選択、説明の最適化、ルール抽出などに応用されています。最適解の保証はありませんが、複雑な問題に対して良い解を見つけることができます。

