# Poincaré Embeddings: 階層的表現学習のためのPoincaré埋め込み

**著者**:
* Maximilian Nickel (Facebook AI Research)
* Douwe Kiela (Facebook AI Research)

**出版**: Advances in Neural Information Processing Systems 30 (NIPS 2017)
**arXiv**: [arXiv:1705.08039](https://arxiv.org/abs/1705.08039)

---

### 概要

この論文では、シンボリックデータ、特に**潜在的な階層構造を持つデータ**の表現学習のために、**双曲空間（hyperbolic space）**、具体的には $n$ 次元**Poincaré球体モデル（Poincaré ball model）**を用いた新しい埋め込み手法「Poincaré Embeddings」が提案されています。従来のユークリッド空間における埋め込みは、階層構造や類似性を効率的にモデル化する上で限界がありました。Poincaré埋め込みは、双曲空間が持つ指数関数的な成長特性を利用することで、階層構造をより効率的かつ簡潔に表現し、同時に高い表現能力と汎化能力を提供します。これは、語彙や知識グラフのような階層的なデータセットにおいて、埋め込みの品質を大幅に向上させることが実験的に示されています。

### 新規性

Poincaré Embeddingsの最も重要な新規性は、**シンボリックデータの階層的表現学習のために双曲空間（特にPoincaré球体モデル）を導入した**点にあります。これは、従来のユークリッド空間ベースの埋め込みモデルが抱えていた、階層構造を効率的にモデル化できないという根本的な課題に対する画期的な解決策を提示しました。

1.  **双曲空間による階層の効率的なモデリング**:
    * 多くの実世界データは階層構造を持っています（例：分類体系、生物学的タクソノミー、語彙の意味関係）。ユークリッド空間では、階層の深くなるにつれて指数関数的に増大するノードを表現するために非常に高い次元が必要となります。
    * 双曲空間は、その負の曲率により、空間が中心から離れるほど指数関数的に拡大するという特性を持っています。この特性は、階層構造の指数関数的な成長と自然に整合し、少ない次元数で広い範囲の階層構造を表現できるという点で、ユークリッド空間よりもはるかに効率的です。
    * これにより、モデルはより簡潔な（少ないパラメータ数の）表現を学習し、埋め込みの容量と汎化能力が向上します。

2.  **リーマン最適化の導入**:
    * 双曲空間は非ユークリッド空間であるため、従来の勾配降下法を直接適用できません。論文では、双曲幾何学に合わせた**リーマン最適化（Riemannian optimization）**手法（例：リーマン確率的勾配降下法 RSGD）を導入し、埋め込み学習を可能にしました。
    * これは、モデル学習の効率性と安定性を保証するための重要な技術的貢献です。

3.  **距離と類似性の両立**:
    * Poincaré埋め込みは、階層関係（親子の距離が近い）とセマンティックな類似性（同じ階層レベルの単語が近い）の両方を同時に効果的に捉えることができます。

### 理論/手法の核心

Poincaré Embeddingsは、シンボリックデータを $n$ 次元の**Poincaré球体モデル** $B_d = \{x \in \mathbb{R}^d \mid ||x|| < 1\}$ に埋め込みます。このモデルでは、球体の中心が階層のルートに近い概念に対応し、境界に近づくにつれて葉の概念に対応します。

1.  **Poincaré距離**:
    * Poincaré球体モデルにおける2点 $\mathbf{u}, \mathbf{v} \in B_d$ 間の距離は、以下の双曲線距離（hyperbolic distance）で定義されます。

    $$
    d(\mathbf{u}, \mathbf{v}) = \text{arccosh}\left(1 + 2 \frac{||\mathbf{u} - \mathbf{v}||^2}{(1 - ||\mathbf{u}||^2)(1 - ||\mathbf{v}||^2)}\right)
    $$
    * ここで、$||\cdot||$ はユークリッドノルムです。
    * この距離尺度は、中心から離れるほど（$||\mathbf{u}||$ や $||\mathbf{v}||$ が1に近づくほど）指数関数的に大きくなります。これにより、階層が深くなるにつれて多くのノードを効率的に配置できるようになります。

2.  **最適化（リーマン最適化）**:
    * Poincaré球体は平坦なユークリッド空間ではないため、通常の勾配降下法は適用できません。代わりに、**リーマン勾配（Riemannian gradient）**を用いて埋め込みを更新するリーマン最適化手法が使用されます。
    * パラメータ更新は以下の形式を取ります。

    $$
    \boldsymbol{\theta}_{t+1} = \text{Exp}_{\boldsymbol{\theta}_t}(-\eta_t \nabla_R \mathcal{L}(\boldsymbol{\theta}_t))
    $$
    ここで、
    * $\eta_t$: 学習率。
    * $\nabla_R \mathcal{L}(\boldsymbol{\theta}_t)$: リーマン勾配。リーマン多様体における勾配の概念であり、通常の勾配を多様体の接空間に投影することで得られます。
    * $\text{Exp}_{\boldsymbol{\theta}_t}(\cdot)$: 多様体上での指数写像（Exponential Map）であり、接空間における勾配ステップを多様体上の点にマッピングし直す操作です。これにより、更新された埋め込みがPoincaré球体内に留まることが保証されます。

3.  **損失関数**:
    * 埋め込み空間においてセマンティックに類似したオブジェクトが近くに配置されるように、問題固有の損失関数 $\mathcal{L}(\boldsymbol{\Theta})$ を最小化します。
    * 例として、タクソノミー（分類体系）埋め込みの場合、以下の損失関数が用いられます。

    $$
    \mathcal{L}(\boldsymbol{\Theta}) = \sum_{(\mathbf{u}, \mathbf{v}) \in \mathcal{D}} \log \frac{e^{-d(\mathbf{u}, \mathbf{v})}}{\sum_{\mathbf{v}' \in \mathcal{N}(\mathbf{u})} e^{-d(\mathbf{u}, \mathbf{v}')}}
    $$
    * $\mathcal{D}$: 観測された親子関係のセット（正例）。
    * $\mathcal{N}(\mathbf{u})$: エンティティ $\mathbf{u}$ の負例のセット（ランダムにサンプリングされた非子ノード）。
    * この損失関数は、正例の距離 $d(\mathbf{u}, \mathbf{v})$ を最小化し、負例の距離 $d(\mathbf{u}, \mathbf{v}')$ を最大化するように学習を促します。

### 「キモ」と重要性

Poincaré Embeddingsの「キモ」は、**双曲空間（Poincaré球体モデル）が持つ負の曲率特性を、知識グラフやタクソノミーといった階層構造の指数関数的な成長と直接的に対応させる**という発想にあります。これにより、少ない次元数で膨大な数のノードと複雑な階層関係を効率的かつ高精度に表現することを可能にしました。

このアイデアの重要性は以下の点に集約されます。

* **階層構造モデリングのブレイクスルー**: 従来のユークリッド空間での埋め込みは、階層の深くなるにつれて指数関数的に増えるノードを表現するのに非常に多くの次元が必要でしたが、双曲空間の「広がり」はこれを自然に解決します。これにより、はるかに少ない次元数で、複雑な階層を忠実に再現できるようになりました。
* **表現能力と簡潔さの両立**: モデルのパラメータ数を抑えながら、高い表現能力と優れた汎化能力を実現します。これは、大規模な階層データセットに対しても効率的かつ効果的な埋め込み学習を可能にします。
* **多様な階層データへの適用**: 語彙（WordNet）、生物学的タクソノミー、ソーシャルネットワークなど、様々な種類の階層データに適用可能であり、これらのドメインでの表現学習の精度を向上させました。
* **新しい数学的基盤の導入**: 双曲幾何学とリーマン最適化を機械学習の文脈に導入したことで、ユークリッド空間以外の幾何学的空間を利用した埋め込みモデルの可能性を広げました。これは、その後の球面埋め込みや他の多様体上の埋め込み研究の基礎を築きました。

Poincaré Embeddingsは、階層的データの埋め込みにおいて画期的なアプローチを提供し、その後の知識グラフ埋め込みや表現学習の分野に大きな影響を与えた、非常に重要な論文であると言えます。