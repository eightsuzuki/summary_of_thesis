# Evaluating Saliency Methods for Neural Language Models

**著者**: Shuoyang Ding (Johns Hopkins University), Philipp Koehn (Johns Hopkins University)  
**会議**: NAACL 2021  
**URL**: [ACL Anthology](https://aclanthology.org/2021.naacl-main.399/)  
**DOI**: [10.18653/v1/2021.naacl-main.399](https://doi.org/10.18653/v1/2021.naacl-main.399)

---

### 概要

この論文は、**ニューラル言語モデルにおける様々なサリエンシー手法（saliency methods）を包括的かつ定量的に評価**した研究です。異なるサリエンシー手法が同じ予測に対して異なる解釈を提供する場合、これらの解釈が分析に使用するのに十分信頼できるかを判断する方法を探求しています。本論文は、**plausibility（妥当性）とfaithfulness（忠実性）という2つの観点から予測解釈の品質を評価**し、構文・意味的合意に関する既存の人間注釈から構築された4つの異なるデータセットで、文レベルと文書レベルの両方で評価を行いました。評価を通じて、サリエンシー手法が低品質な解釈を生成する様々な方法を特定し、ニューラル言語モデルにこのような手法を展開する将来の研究では、洞察を導き出す前に解釈を慎重に検証すべきであることを推奨しています。

---

### 論文の核心：サリエンシー手法の体系的評価

#### 1. 研究の背景と動機

##### サリエンシー手法の多様性

NLPタスクでは、様々なサリエンシー手法が提案されていますが、その評価方法は統一されていません：

- **勾配ベース手法**: Gradient、Gradient × Input、Integrated Gradientsなど
- **摂動ベース手法**: LIME、SHAPなど
- **注意ベース手法**: Attention weights、Attention rolloutなど

##### 評価の困難さ

NLPタスクにおけるサリエンシー手法の評価は、以下の理由で困難です：

- **正解の不在**: どの単語が本当に重要かという「正解」が存在しない
- **ベースラインの影響**: ベースライン選択が説明結果に大きく影響する
- **評価指標の不一致**: 異なる評価指標が異なる結果を示す

#### 2. ベースライン選択の重要性

##### <PAD>トークンなどの固定ベースライン

本論文では、**<PAD>トークンや<UNK>トークンをベースラインとして使用する場合の影響**を詳細に評価しています：

- **<PAD>トークン**: パディング用のトークンで、文の長さを揃えるために使用される
- **<UNK>トークン**: 未知語を表すトークン
- **固定ベースラインの問題**: これらのトークンをベースラインに使用すると、特定のパターンが強調されたり、無視されたりする可能性がある

##### ベースライン選択がサリエンシーに与える影響

論文では、以下の点を明らかにしています：

- **説明の一貫性**: ベースライン選択により、説明の一貫性が大きく変わる
- **重要度の分布**: 異なるベースラインを使用すると、重要度の分布が大きく異なる
- **評価指標への影響**: ベースライン選択が評価指標の結果に影響を与える

---

### 技術的な詳細

#### 1. 評価対象のサリエンシー手法

論文では、以下のサリエンシー手法を評価しています：

##### 勾配ベース手法

- **Gradient**: 入力に対する勾配
- **Gradient × Input**: 勾配と入力の要素積
- **Integrated Gradients**: ベースラインから入力までの経路に沿って勾配を積分
- **Expected Gradients**: 複数のベースラインからの期待値

##### 摂動ベース手法

- **LIME**: 局所的な線形モデルで近似
- **SHAP**: Shapley値に基づく説明

##### 注意ベース手法

- **Attention Weights**: 注意重みを直接使用
- **Attention Rollout**: 注意重みを層間で伝播

#### 2. 評価指標

論文では、**plausibility（妥当性）とfaithfulness（忠実性）という2つの観点から予測解釈の品質を評価**しています：

##### Plausibility（妥当性）

- **人間の注釈との一致**: 説明が人間の注釈（構文・意味的合意）とどれだけ一致するかを測定
- **直感性**: 説明が人間にとって直感的で理解しやすいかどうか
- **意味的な整合性**: 説明が意味的に整合性があるかどうか

##### Faithfulness（忠実性）

- **予測への寄与**: 説明がモデルの予測にどれだけ忠実かを測定
- **特徴の重要度**: 説明された重要度が実際の寄与と一致するかを検証
- **モデルの動作との一致**: 説明がモデルの実際の動作を反映しているかどうか

#### 3. ベースラインの種類

論文では、以下のベースラインを比較しています：

- **ゼロベクトル**: すべての埋め込みをゼロに設定
- **<PAD>トークン**: パディングトークンの埋め込みを使用
- **<UNK>トークン**: 未知語トークンの埋め込みを使用
- **平均埋め込み**: 訓練データの平均埋め込みを使用
- **ランダム埋め込み**: ランダムにサンプリングされた埋め込みを使用

---

### 実験と評価

#### 1. 実験設定

##### データセット

論文では、**構文・意味的合意に関する既存の人間注釈から構築された4つの異なるデータセット**を使用しています：

- **構文的合意**: 構文的な合意に関するデータセット
- **意味的合意**: 意味的な合意に関するデータセット
- **文レベル**: 文レベルの評価
- **文書レベル**: 文書レベルの評価

##### モデル

- **ニューラル言語モデル**: 様々なニューラル言語モデルを評価

#### 2. 主要な結果

##### ベースライン選択の影響

- **<PAD>トークンの問題**: <PAD>トークンをベースラインに使用すると、特定のパターンが強調されたり、無視されたりする
- **ゼロベクトルの限界**: ゼロベクトルをベースラインに使用すると、OOD問題が発生する
- **平均埋め込みの優位性**: 平均埋め込みをベースラインに使用すると、より安定した説明が得られる

##### サリエンシー手法の比較

- **勾配ベース手法**: Integrated GradientsやExpected Gradientsが比較的良好な性能を示す
- **注意ベース手法**: Attention weightsは直感的だが、忠実性に問題がある場合がある
- **摂動ベース手法**: LIMEやSHAPは計算コストが高いが、忠実性が高い場合がある

#### 3. 実践的な示唆

##### ベースライン選択の推奨事項

- **訓練データ分布の使用**: 可能であれば、訓練データの分布を反映したベースラインを使用する
- **複数ベースラインの平均**: Expected Gradientsのように、複数のベースラインを平均する手法が好ましい
- **固定ベースラインの回避**: <PAD>トークンやゼロベクトルなどの固定ベースラインは、慎重に使用する

##### 評価方法の改善

- **複数の評価指標**: 単一の評価指標に依存せず、複数の評価指標を使用する
- **人間による評価**: 可能な限り人間による評価も組み合わせる
- **タスク依存性**: タスクやモデルに応じて適切な評価方法を選択する

---

### 論文の意義と影響

#### 1. 評価方法の確立

この論文は、NLPタスクにおけるサリエンシー手法の評価方法を確立しました：

- **体系的評価**: 様々なサリエンシー手法を体系的に評価
- **評価指標の統一**: 評価指標を統一し、比較可能にした
- **ベースラインの重要性**: ベースライン選択の重要性を明確に示した

#### 2. ベースライン選択の重要性の強調

この論文は、**ベースライン選択の重要性を明確に示し**、多くの実践でデフォルトとして使われる<PAD>トークンやゼロベクトルを用いた固定ベースラインの安易な使用を再考させました：

- **固定ベースラインの限界**: <PAD>トークンやゼロベクトルなどの固定ベースラインの限界を明確に示した
- **適切なベースラインの選択**: 訓練データ分布に基づくベースラインの重要性を強調
- **実践への影響**: 多くの研究や実務で、ベースライン選択がより慎重に検討されるようになった

#### 3. 解釈可能性研究への影響

この論文は、解釈可能性研究に以下のような影響を与えました：

- **評価方法の見直し**: サリエンシー手法の評価方法を見直すきっかけとなった
- **ベースラインの標準化**: ベースライン選択に関する標準的なガイドラインの必要性を示した
- **実践的な指針**: 実践的な指針を提供し、研究と実務の橋渡しをした

---

### 技術的な革新点

#### 1. 体系的評価

この論文の最大の革新点は、**様々なサリエンシー手法を体系的に評価**したことです：

- **包括的な比較**: 勾配ベース、摂動ベース、注意ベースの手法を包括的に比較
- **複数の評価指標**: 忠実性、一貫性、人間による評価など、複数の評価指標を使用
- **再現性**: 評価方法を明確に記述し、再現可能にした

#### 2. ベースライン選択の詳細な分析

ベースライン選択がサリエンシーに与える影響を詳細に分析しました：

- **様々なベースラインの比較**: ゼロベクトル、<PAD>トークン、平均埋め込みなど、様々なベースラインを比較
- **影響の定量化**: ベースライン選択が説明結果に与える影響を定量化
- **実践的な推奨事項**: 実践的な推奨事項を提供

#### 3. 評価方法の標準化

評価方法を標準化し、比較可能にしました：

- **評価指標の統一**: 評価指標を統一し、異なる手法を比較可能にした
- **評価プロトコル**: 評価プロトコルを明確に記述
- **再現性の確保**: 再現性を確保するための詳細な記述

---

### 限界と今後の課題

#### 1. 評価指標の限界

- **正解の不在**: NLPタスクでは、どの単語が本当に重要かという「正解」が存在しない
- **主観性**: 人間による評価は主観的で、評価者の先入観に左右される
- **タスク依存性**: 最適な評価指標はタスクやモデルに依存する可能性

#### 2. ベースライン選択のガイドライン

- **タスク依存性**: 最適なベースラインはタスクやモデルに依存する可能性
- **汎用的なガイドライン**: 様々なタスクに適用可能なベースライン選択のガイドラインが必要
- **自動選択**: 適切なベースラインを自動的に選択する手法の開発

#### 3. 評価方法の改善

- **より客観的な評価**: より客観的な評価方法の開発
- **計算効率**: 評価方法の計算効率の向上
- **スケーラビリティ**: 大規模なモデルやデータセットでの評価方法の開発

---

### 実践的な示唆

#### 1. ベースライン選択の推奨事項

論文の結果から、以下の推奨事項が導き出されます：

- **訓練データ分布の使用**: 可能であれば、訓練データの分布を反映したベースラインを使用する
- **複数ベースラインの平均**: Expected Gradientsのように、複数のベースラインを平均する手法が好ましい
- **固定ベースラインの慎重な使用**: <PAD>トークンやゼロベクトルなどの固定ベースラインは、慎重に使用する

#### 2. 評価方法の改善

- **複数の評価指標**: 単一の評価指標に依存せず、複数の評価指標を使用する
- **人間による評価**: 可能な限り人間による評価も組み合わせる
- **タスク依存性**: タスクやモデルに応じて適切な評価方法を選択する

#### 3. 実装時の注意点

- **ベースラインのドキュメント化**: 使用したベースラインを明確にドキュメント化する
- **検証**: ベースライン選択が説明に与える影響を検証する
- **比較**: 可能であれば、複数のベースラインを比較する

---

### まとめ

「Evaluating Saliency Methods for Neural Language Models」は、機械翻訳や言語モデルにおいて、様々なサリエンシー手法を体系的に評価した重要な研究です。特に、ベースラインの選択（<PAD>トークンなどをベースラインとした場合）がサリエンシーマップの品質にどう影響するかを詳細に議論し、ベースライン選択の重要性を明確に示しました。この論文は、NLPタスクにおける説明可能性手法の評価方法を確立し、多くの研究や実務で、ベースライン選択がより慎重に検討されるようになりました。

今後の研究では、より客観的な評価方法の開発、ベースライン選択の自動化、評価方法の計算効率の向上などが重要な課題となるでしょう。
