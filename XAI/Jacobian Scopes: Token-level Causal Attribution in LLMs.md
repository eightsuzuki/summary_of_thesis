# Jacobian Scopes: Token-level Causal Attribution in LLMs

**著者**: Liu et al.  
**年**: 2025  
**論文**: Jacobian Scopes: Token-level Causal Attribution (LLM におけるトークン単位の因果的帰属)  
**arXiv**: https://arxiv.org/html/2601.16407v1

---

## 一言で

**最終隠れ状態のヤコビ行列を解析し、特定ロジット感度や予測分布全体への影響をベクトル化する**。解釈の次元は**隠れ層/語彙次元**（ターゲットに応じて変わる）。

---

## 位置づけ

大規模言語モデル（LLM）の解釈においては、特定の単語の予測確率だけでなく、**予測分布全体の変化**を捉える必要がある。この課題に対し、ヤコビ行列を利用して多次元的な影響を分析する手法群が「**ヤコビアン・スコープ（Jacobian Scopes）**」として提案されている。単一のスカラー値ではなく、特定の目的に応じた「スコープ」として寄与が再構成される。

---

## 二つのスコープ

入力トークンの埋め込みベクトル $x_t$ が最終的な隠れ状態 $y$ に与える影響を、ヤコビ行列 $J_t = \partial y / \partial x_t \in \mathbb{R}^{d_{model} \times d_{model}}$ を通じて解析する。

### セマンティック・スコープ (Semantic Scope)

特定のターゲット語彙のロジットに対する感度を、アンエンベディング行列の特定の行ベクトル $w_{target}$ とヤコビ行列の積 $\|w_{target}^T J_t\|_2$ として算出する。特定の**出力コンポーネント**（語彙の1次元）への寄与を抽出しつつ、入力側の全次元の影響を統合したもの。

### フィッシャー・スコープ (Fisher Scope)

単一のロジットではなく、**予測分布 $p(\cdot | X_{1:T})$ 全体**への影響を捉える。出力空間の各次元（全語彙）に対する影響のベクトルを扱うことに相当し、モデルの「確信度」や「不確実性」がどの入力によって形成されたかを明らかにする。モデルが特定の政治的バイアスをどのように分布の「裾」に含ませているか、あるいはコンテキストをどのように利用して確率分布をシフトさせているかを、多次元的な視点から浮き彫りにする。

---

## 比較メモ（ベクトル値寄与サーベイ内での整理）

| 項目 | 内容 |
|------|------|
| 手法名 | Jacobian Scopes |
| 寄与ベクトルの構成 | 最終隠れ状態のヤコビ行列を解析し、特定ロジット感度や予測分布全体への影響をベクトル化 |
| 解釈の次元 | 隠れ層/語彙次元 |

---

## 関連

- [統合勾配法におけるベクトル値特徴量寄与_サーベイ](./統合勾配法におけるベクトル値特徴量寄与_サーベイ.md) — セクション 4 で Jacobian Scopes を概説
