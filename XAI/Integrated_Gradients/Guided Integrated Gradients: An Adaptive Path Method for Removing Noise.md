# Guided Integrated Gradients: An Adaptive Path Method for Removing Noise

**著者**: Andrei Kapishnikov, Subhashini Venugopalan, Besim Avci, Ben Wedin, Michael Terry, Tolga Bolukbasi  
**会議**: CVPR 2021  
**年**: 2021  
**ページ**: 5050-5058  
**arXiv**: arXiv:2106.09788  
**DOI**: 10.48550/arXiv.2106.09788  
**URL**: [https://arxiv.org/abs/2106.09788](https://arxiv.org/abs/2106.09788)  
**GitHub**: [https://github.com/PAIR-code/saliency](https://github.com/PAIR-code/saliency)

---

## 概要

Integrated Gradients (IG) は深層ニューラルネットワークの特徴アトリビューション手法として広く使用されていますが、視覚モデルに適用した際に、予測クラスに関連しない領域でスプリアス/ノイズの多いピクセルアトリビューションを生成する問題があります。本論文では、この問題の原因の一つがIG経路に沿ったノイズの蓄積であることを示し、**Adaptive Path Methods (APMs)** を一般化として提案し、**Guided IG** をその具体的な実例として紹介しています。

---

## 問題の背景

### IGのノイズ問題

IGは多くの望ましい性質を持っていますが、視覚モデルに適用した際に以下の問題が発生します：

- **スプリアス/ノイズの多いピクセルアトリビューション**: 予測クラスに関連しない領域でノイズが発生
- **既存の解決策の限界**: ほとんどの既存の解決策は、結果のアトリビューションのノイズを明示的に削減することで症状に対処することを目的としている

### 本論文のアプローチ

本論文では、**症状ではなく原因に対処**するアプローチを取ります：

- **原因の特定**: IG経路に沿ったノイズの蓄積が問題の原因の一つであることを示す
- **経路の適応**: アトリビューション経路自体を適応させることで、このノイズ源の影響を最小化
- **条件付き経路**: 経路を画像だけでなく、説明対象のモデルにも条件付ける

---

## 主要な貢献

### 1. Adaptive Path Methods (APMs) の提案

**APMs** は、標準的なパス法を一般化したものです：

- **標準的なパス法**: 固定された直線経路（例：IGの直線補間）
- **APMs**: 入力画像と説明対象のモデルの両方に条件付けられた適応的な経路

### 2. Guided IG の導入

**Guided IG** は、APMsの具体的な実例です：

- **経路の適応**: ベースラインから入力へ移動する際に、関連する偏微分の絶対値が最も低い特徴を選択
- **ノイズの最小化**: 無関係な高勾配領域の影響を最小化
- **計算効率**: 標準IGと同じ漸近時間計算量を維持

### 3. 公理的性質の保持

Guided IGは、標準IGと同じ公理セットを満たします：

- **Completeness（完全性）**: アトリビューションの総和が出力差分と一致
- **Sensitivity（感度）**: 入力とベースラインで異なる特徴は非ゼロのアトリビューションを持つ
- **Implementation Invariance（実装不変性）**: 機能的に同一のモデルは同一のアトリビューションを生成

---

## 技術的な詳細

### Guided IG のアルゴリズム

Guided IGは、ベースラインから入力へ移動する際に、以下の戦略を採用します：

1. **特徴の選択**: 関連する偏微分の絶対値が最も低い特徴を選択
2. **経路の構築**: 選択された特徴に沿って経路を構築
3. **積分の計算**: 構築された経路に沿って勾配を積分

このアプローチにより、無関係な高勾配領域の影響を最小化し、より意味のあるアトリビューションを生成します。

### 計算効率

- **時間計算量**: 標準IGと同じ漸近時間計算量 $O(n \times m)$ を維持
  - $n$: 特徴数
  - $m$: 積分ステップ数
- **実装**: 効率的な実装により、実用的な計算時間を実現

---

## 実験と評価

### 実験設定

**モデル**: 5つの異なるモデルを使用
- 画像分類モデル（自然画像）
- 医療画像モデル（糖尿病性網膜症）

**データセット**: 3つのデータセット
- 自然画像データセット
- 糖尿病性網膜症データセット

**評価指標**:
- **Weak Localization**: 弱い局所化性能の評価
- **PIC (Pointing Game)**: ポイントゲーム指標

### 主要な結果

**定性的評価**:
- Guided IGは、モデルの予測と入力画像により良く整合したサリエンシーマップを生成
- ノイズが大幅に削減され、より解釈しやすいアトリビューションを提供

**定量的評価**:
- **Weak Localization**: 他のピクセルベースのアトリビューション手法を上回る性能
- **PIC指標**: ほぼすべての実験で、他の関連手法を上回る性能
- **5つのモデルと3つのデータセット**: 一貫して優れた性能を示す

---

## 論文の意義と影響

### 1. ノイズ問題への根本的なアプローチ

本論文は、IGのノイズ問題に対して、**症状ではなく原因に対処する**根本的なアプローチを提供します：

- **従来のアプローチ**: 結果のアトリビューションのノイズを明示的に削減
- **本論文のアプローチ**: 経路自体を適応させることで、ノイズ源の影響を最小化

### 2. Adaptive Path Methods の一般化

**APMs** の提案により、将来の研究において、より柔軟な経路選択が可能になります：

- **標準的なパス法**: 固定された経路（例：直線補間）
- **APMs**: 入力とモデルに条件付けられた適応的な経路

### 3. 実用的な改善

Guided IGは、標準IGと同じ計算効率を維持しながら、より優れたアトリビューションを提供します：

- **計算効率**: 標準IGと同じ漸近時間計算量
- **性能向上**: 定性的・定量的に優れた結果
- **実装**: 実用的な実装が提供されている

---

## 限界と今後の課題

### 1. 計算コスト

- **経路の構築**: 適応的な経路の構築には追加の計算が必要
- **最適化**: より効率的な経路構築アルゴリズムの開発が課題

### 2. 一般化

- **ドメイン依存性**: 視覚モデルに焦点を当てているが、他のドメイン（NLPなど）への適用が課題
- **モデル依存性**: 異なるアーキテクチャでの性能の検証が必要

### 3. 理論的理解

- **経路選択の理論**: 最適な経路選択の理論的理解が課題
- **ノイズの理論**: ノイズの蓄積メカニズムのより深い理論的理解が必要

---

## 実践的な示唆

### 1. アトリビューション手法の選択

- **ノイズが問題となる場合**: Guided IGは、標準IGよりも優れたアトリビューションを提供
- **計算効率**: 標準IGと同じ計算効率を維持
- **実装**: 実用的な実装が利用可能

### 2. 評価方法

- **定性的評価**: 視覚的な評価が重要
- **定量的評価**: Weak LocalizationやPIC指標などの定量的評価も重要
- **複数の指標**: 複数の評価指標を使用することが推奨される

### 3. 実装時の注意点

- **経路の構築**: 適応的な経路の構築には注意が必要
- **計算効率**: 大規模なモデルやデータセットでは、計算効率を考慮する必要がある

---

## まとめ

「Guided Integrated Gradients: An Adaptive Path Method for Removing Noise」は、IGのノイズ問題に対して、**症状ではなく原因に対処する**根本的なアプローチを提供する重要な研究です。**Adaptive Path Methods (APMs)** を一般化として提案し、**Guided IG** をその具体的な実例として紹介しています。実験結果は、Guided IGが標準IGと同じ計算効率を維持しながら、より優れたアトリビューションを提供することを示しています。

この論文の影響は大きく、今後の研究において、より柔軟な経路選択が可能になり、アトリビューション手法の改善が期待されます。特に、視覚モデルにおけるアトリビューションの品質向上に大きく貢献する研究です。
