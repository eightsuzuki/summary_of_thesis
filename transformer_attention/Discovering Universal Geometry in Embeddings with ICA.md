# Discovering Universal Geometry in Embeddings with ICA

**著者**: Hiroaki Yamagiwa (京都大学), Momose Oyama (京都大学), Hidetoshi Shimodaira (京都大学)  
**arXiv**: [arXiv:2305.13175](https://arxiv.org/abs/2305.13175)

単語埋め込みにICA を使用すると、単語の埋め込みのセットから独立した意味コンポーネントを抽出できます。これらのコンポーネントを埋め込み軸として活用することで、各単語を固有 (元の埋め込みに固有) 軸と解釈可能な (スパースで一貫性のある) 軸の組み合わせとして表現できると予想されます。私たちの実験では、各単語を表すために必要な次元の数は埋め込みの実際の次元よりもかなり少なく、解釈可能性が向上することが示唆されています。

---

### 概要

この研究では、**独立成分分析 (Independent Component Analysis: ICA)** を用いて、単語や画像の埋め込みに一貫した意味構造が存在することを明らかにしました。主成分分析 (PCA) の後に残る**異方性情報**を活用して、事前学習済みモデルの埋め込みから独立した意味成分を抽出し、これが異なる言語やアルゴリズム、モダリティ（単語や画像）にわたって一貫していることを示しました。

---

### 主な結果

1. **意味軸の抽出**
    - 埋め込みは、いくつかの独立かつ解釈可能な軸の組み合わせとして表現できる。
    - 例: 「Ferrari」は [cars] + [Italian] の軸で表現される。
2. **ICAとPCAの比較**
    - ICAは三次モーメント（歪度）や四次モーメント（尖度）を活用して、独立した意味軸を発見。
    - PCAではこれらの高次モーメントを考慮しないため、解釈性が劣る。
3. **普遍性**
    - ICAで抽出した軸は、異なる言語、アルゴリズム（fastText, BERTなど）、およびモダリティ（画像モデル）でも共有される。
4. **解釈性の向上**
    - 単語侵入タスク（word intrusion task）を用いて、ICAで変換した埋め込みの軸が他の手法（PCA, ZCA, Varimax）よりも一貫した意味を持つことを確認。
5. **次元削減**
    - ICAでは少数の軸のみで単語の意味を効果的に表現できる。例: アナロジータスクで高い性能を発揮。

---

### 数式の要点

1. **PCAの変換**
    $$
    Z=XAZ = XA
    $$
    - $X∈Rn×dX \in \mathbb{R}^{n \times d}$: 埋め込み行列（行が単語、列が次元）。
    - AA: PCAによる変換行列。
2. **ICAの変換**
    $$
    S=XBS = XB
    $$
    
    - BB: ICAによる変換行列。
    - SS: ICA変換後の埋め込み行列。
3. **非ガウス性の最大化**
    - ICAでは、正規分布からの偏差（非ガウス性）を最大化することで独立成分を抽出。

---

この研究の重要性は、埋め込み空間の解釈性を向上させることにより、モデルの透明性や効率性を高める点にあります。また、言語やモダリティをまたいだ普遍的な意味構造を発見したことは、マルチモーダルAIへの応用可能性を示唆しています。

---

### 1. **中心化 (Centering)**

埋め込み行列 XX の各列（次元）から平均値を引き、データの中心を原点に移動させています。これにより、以下が実現されます：

- データの分布が対称的になり、解析が容易になる。
- 主成分分析 (PCA) や独立成分分析 (ICA) を適切に適用する準備が整う。
$$
Xcentered=X−mean(X)X_\text{centered} = X - \text{mean}(X)
$$
---

### 2. **ホワイトニング (Whitening)**

PCAを用いて埋め込みデータをホワイトニングし、データの分散が各次元で均一になるようにしています。これにより、次の特徴を持つデータが得られます：

- 次元間の相関がなくなる（無相関化）。
- 高次元空間での解析がしやすくなる。

PCAによる変換：

Z=XAZ = XA

ここで、AA は変換行列で、主成分方向を基準に分散を正規化します。

---

### 3. **独立成分分析 (ICA)**

PCAでホワイトニングしたデータに対してICAを適用し、次のような**独立成分**を抽出しています：

- 高次モーメント（歪度や尖度）を利用して、埋め込みの意味的な構造を強調。
- 各次元が異なる「意味軸」を持つように変換。

ICAの変換式：
$$
S=XBS = XB
$$
ここで、$B$ はICAの変換行列で、独立成分が得られるようデータを回転・スケーリングします。

---

### 4. **軸の整列 (Axis Alignment)**

異なる埋め込み間で共通の意味軸を見つけるため、以下のように軸を整列させています：

- **相関係数**を使用して、異なる言語やモデル間での軸対応を確認。
- 英語を基準に、他の言語やモダリティの軸を並べ替え。

---

| 特徴 | PCAの軸 | ICAの軸 |
| --- | --- | --- |
| 定義 | 分散を最大化する方向 | 独立成分を表す方向 |
| 基準 | 共分散行列の固有ベクトル | 非ガウス性（高次モーメント） |
| 解釈性 | 分散を説明するが、解釈が難しい | 意味的に解釈可能 |
| 例 | 主成分軸1 = データの最大分散方向 | 軸1 = [cars], 軸2 = [Italian] |